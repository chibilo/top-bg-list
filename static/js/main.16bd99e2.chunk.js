(this.webpackJsonptop10bg=this.webpackJsonptop10bg||[]).push([[0],{46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},50:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(18),i=n.n(c),r=(n(46),n(16)),s=n(5),l=(n(47),{Tesera:{title:"Tesera",linkIdField:"alias",makeLink:function(e){return"https://tesera.ru/game/".concat(e)},ratingField:"ratingUser",sortField:"-ratingn10"},BGG:{title:"BoardGameGeek",linkIdField:"bggId",makeLink:function(e){return"https://www.boardgamegeek.com/boardgame/".concat(e)},ratingField:"bggGeekRating",sortField:"-ratinggeekbgg"}}),o=n(83),j=n(79),d=(n(48),n(1)),u=function(e){var t=e.info,n=e.onClick;return Object(d.jsxs)(o.a,{onClick:function(){return n(t)},children:[Object(d.jsx)(o.a.Img,{src:t.photoUrl,alt:"game image"}),Object(d.jsxs)(o.a.ImgOverlay,{children:[Object(d.jsx)("div",{className:"rating",children:t.numRating}),Object(d.jsx)(j.a,{className:"pull-right",variant:"success",title:"rating",children:t.gameRating})]}),Object(d.jsxs)(o.a.Body,{style:{zIndex:1e3},children:[Object(d.jsx)(o.a.Title,{children:t.title}),Object(d.jsx)(o.a.Text,{children:t.descriptionShort}),t.links.map((function(e,t){return Object(d.jsx)(o.a.Link,{as:"a",href:e.href,target:"_blank",children:e.title},t)}))]})]})},b=(n(50),function(e){var t=e.data,n=Object(s.f)();return Object(d.jsx)("div",{className:"game-list",children:t.map((function(e){return Object(d.jsx)(u,{info:e,onClick:function(e){return n.push("/game/".concat(e.alias))}},e.id)}))})}),h=(n(56),Object(a.memo)((function(e){var t=e.value,n=e.items,a=e.onChange;return Object(d.jsxs)("div",{className:"custom-dropdown",children:[t,Object(d.jsx)("ul",{className:"custom-dropdown-menu",children:n.map((function(e,n){var c;return Object(d.jsx)("li",{onClick:function(){var n,c=null!==(n=e.value)&&void 0!==n?n:e;c!==t&&a(c)},children:null!==(c=e.text)&&void 0!==c?c:e},n)}))})]})}))),O=n(84),m=(n(57),Object(a.memo)((function(e){var t=e.pageCount,n=e.activePage,a=e.onChangePage;return Object(d.jsx)(O.a,{children:Array.from(Array(t).keys()).map((function(e,t){return Object(d.jsx)(O.a.Item,{active:n===e+1,onClick:function(e){var t=Number(e.target.text||n);a(t),window.scrollTo({top:0,behavior:"smooth"})},children:e+1},t)}))})}))),g=n(82),f=n(20),x=n(7),p=n(26),v=n.n(p),y="https://api.tesera.ru/games",k=function(e){return Object.values(l).map((function(t){var n=t.title,a=t.linkIdField;return{title:n,href:(0,t.makeLink)(e[a])}}))},N="LOAD_GAME_LIST",C="LOAD_GAME_LIST_SUCCESS",L="LOAD_GAME_LIST_ERROR",w="SET_PAGE",G={list:[],host:"BGG",limit:10,page:1,isLoading:!1,error:null},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(x.a)(Object(x.a)({},e),{},{isLoading:!0,host:t.payload.host,limit:t.payload.limit,list:[]});case C:return Object(x.a)(Object(x.a)({},e),{},{isLoading:!1,list:t.payload});case L:return Object(x.a)(Object(x.a)({},e),{},{isLoading:!1,list:[],error:t.payload});case w:return Object(x.a)(Object(x.a)({},e),{},{page:t.payload});default:return e}},R=Object(a.createContext)(),S=function(e){var t=e.children,n=Object(a.useReducer)(I,G),c=Object(f.a)(n,2),i=c[0],r=c[1];return Object(d.jsx)(R.Provider,{value:{games:i,dispatch:r,fetch:function(e,t){r(function(e,t){return{type:N,payload:{host:e,limit:t}}}(e,t)),function(e,t){var n,a=(null===(n=l[e])||void 0===n?void 0:n.sortField)||"-ratingn10";return v.a.get("".concat(y,"?offset=",0,"&limit=").concat(t,"&WithAdditions=false&sort=").concat(a)).then((function(t){var n,a=(null===(n=l[e])||void 0===n?void 0:n.ratingField)||"ratingUser";return t.data.map((function(e,t){return Object(x.a)(Object(x.a)({},e),{},{numRating:t+1,gameRating:e[a],links:k(e)})}))}))}(e,t).then((function(e){r(function(e){return{type:C,payload:e}}(e))})).catch((function(e){var t;r((t=e.message,{type:C,payload:t}))}))},setPage:function(e){r(function(e){return{type:w,payload:e}}(e))}},children:t})};function A(){var e=Object(a.useContext)(R),t=e.games,n=t.host,c=t.limit,i=t.page,r=t.isLoading,s=t.error,o=t.list,j=e.fetch,u=e.setPage,O=Math.ceil(c/10);return O<i&&u(1),Object(a.useEffect)((function(){j(n,c)}),[]),Object(d.jsxs)("div",{className:"games",children:[Object(d.jsxs)("h1",{children:["\u0422\u043e\u043f"," ",Object(d.jsx)(h,{value:c,items:[10,25,50,100],onChange:function(e){return j(n,e)}})," ","\u041d\u0430\u0441\u0442\u043e\u043b\u044c\u043d\u044b\u0445 \u0418\u0433\u0440 \u043f\u043e \u0432\u0435\u0440\u0441\u0438\u0438"," ",Object(d.jsx)(h,{value:l[n].title,items:Object.entries(l).map((function(e){return{value:e[0],text:e[1].title}})),onChange:function(e){return j(e,c)}})]}),r?Object(d.jsx)(g.a,{transition:!1,className:"alert",show:r,variant:"info",children:"Loading..."}):o&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(b,{data:o.slice(10*(i-1),10*i)}),c>10&&Object(d.jsx)(m,{pageCount:O,onChangePage:u,activePage:i})]}),s&&Object(d.jsx)("div",{children:s})]})}n(76);var E=n(81),T=n(40),_=n(80),F=["children"],M=function(e){var t=e.children,n=Object(T.a)(e,F),a=Object(s.f)();return Object(d.jsx)(_.a,Object(x.a)(Object(x.a)({},n),{},{onClick:function(){return a.push("/")},children:t}))};function P(){var e=Object(s.g)().id,t=Object(a.useState)(null),n=Object(f.a)(t,2),c=n[0],i=n[1],r=Object(a.useState)(!0),l=Object(f.a)(r,2),o=l[0],j=l[1];return Object(a.useEffect)((function(){j(!0),function(e){return v.a.get("".concat(y,"/").concat(e)).then((function(e){var t=e.data.game;return Object(x.a)(Object(x.a)({},t),{},{links:k(t)})}))}(e).then(i).finally((function(){return j(!1)}))}),[]),o?Object(d.jsx)("div",{className:"game-page",children:Object(d.jsx)(E.a,{animation:"border",variant:"secondary"})}):Object(d.jsxs)("div",{className:"game-page m-2 overflow-hidden",children:[c?Object(d.jsxs)("div",{className:"game d-flex flex-column align-items-center justify-content-center px-4 py-2 m-3 shadow-sm ",children:[Object(d.jsx)("h1",{className:"text-center\t",children:c.title}),c.title2&&Object(d.jsx)("h3",{className:"text-center mt-2",children:c.title2}),Object(d.jsxs)("div",{className:"params d-flex align-items-start align-self-start mt-3",children:[Object(d.jsx)("img",{src:c.photoUrl,alt:"game image",width:"300px"}),Object(d.jsxs)("div",{className:"details ml-3",children:[Object(d.jsxs)("p",{children:["\u0420\u0435\u0439\u0442\u0438\u043d\u0433 BGG: ",c.bggRating]}),Object(d.jsxs)("p",{children:["\u0420\u0435\u0439\u0442\u0438\u043d\u0433 Tesera: ",c.n10Rating]}),Object(d.jsxs)("p",{children:["\u0413\u043e\u0434 \u0432\u044b\u0445\u043e\u0434\u0430: ",c.year]}),Object(d.jsxs)("p",{children:["\u0418\u0433\u0440\u043e\u043a\u0438: ",c.playersMin," - ",c.playersMax]}),Object(d.jsxs)("p",{children:["\u0412\u043e\u0437\u0440\u0430\u0441\u0442: \u043e\u0442 ",c.playersAgeMin," \u043b\u0435\u0442"]}),Object(d.jsxs)("p",{children:["\u0412\u0440\u0435\u043c\u044f \u043f\u0430\u0440\u0442\u0438\u0438: ",c.playtimeMin," - ",c.playtimeMax," \u043c\u0438\u043d"]})]})]}),Object(d.jsx)("div",{className:"desc pt-2 mt-3",children:c.descriptionShort}),Object(d.jsx)("div",{className:"d-flex py-2",children:c.links.map((function(e){return Object(d.jsx)("a",{className:"p-2",href:e.href,target:"_blank",children:e.title},e.title)}))})]}):Object(d.jsx)("div",{children:"\u0422\u0430\u043a\u043e\u0439 \u0438\u0433\u0440\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e."}),Object(d.jsx)(M,{variant:"outline-secondary",children:"Back to Game List"})]})}function B(){var e=Object(s.f)();return Object(a.useEffect)((function(){setTimeout((function(){return e.push("/")}),2e3)}),[]),Object(d.jsx)("div",{children:Object(d.jsx)("h3",{children:"Page not found. Redirecting to main page..."})})}function U(){return Object(d.jsx)(S,{children:Object(d.jsx)(r.a,{children:Object(d.jsxs)(s.c,{children:[Object(d.jsx)(s.a,{path:"/game/:id",children:Object(d.jsx)(P,{})}),Object(d.jsx)(s.a,{path:"/",exact:!0,children:Object(d.jsx)(A,{})}),Object(d.jsx)(s.a,{path:"*",children:Object(d.jsx)(B,{})})]})})})}var D=document.getElementById("root");i.a.render(Object(d.jsx)(a.StrictMode,{children:Object(d.jsx)(U,{})}),D)}},[[77,1,2]]]);
//# sourceMappingURL=main.16bd99e2.chunk.js.map